<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Royal Correspondence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        parchment: '#f5e9d5',
                        'parchment-dark': '#e8d9b5',
                        ink: '#2a2118',
                        'wax-red': '#a83232',
                        'wax-gold': '#d4af37',
                        'royal-purple': '#4a306d',
                        'royal-blue': '#1a1a2e',
                    },
                    fontFamily: {
                        cormorant: ['Cormorant Garamond', 'serif'],
                        marcellus: ['Marcellus', 'serif'],
                        playfair: ['Playfair Display', 'serif'],
                    },
                    animation: {
                        'wax-drip': 'waxDrip 2s infinite',
                        'float-in': 'floatIn 0.8s ease-out',
                        'fly': 'fly 15s linear infinite',
                        'feather-fall': 'featherFall linear forwards',
                        'pulse-slow': 'pulse 3s ease-in-out infinite',
                        'seal-spin': 'spin 1s linear',
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Marcellus&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    <style type="text/css">
        @keyframes floatIn {
            0% { transform: translateY(30px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }

        @keyframes fly {
            0% { 
                transform: translateX(-100px) translateY(100px) rotate(-10deg);
                opacity: 0;
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { 
                transform: translateX(calc(100vw + 100px)) translateY(-100px) rotate(10deg);
                opacity: 0;
            }
        }

        @keyframes featherFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 0.8;
            }
            100% {
                transform: translateY(calc(100vh + 100px)) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes waxDrip {
            0% { transform: translateY(-10px) scaleY(0.8); opacity: 0; }
            50% { transform: translateY(0) scaleY(1); opacity: 1; }
            100% { transform: translateY(10px) scaleY(0.8); opacity: 0; }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .scroll-container {
            scroll-snap-type: y mandatory;
            height: 100vh;
            overflow-y: scroll;
        }

        .scroll-section {
            scroll-snap-align: start;
        }

        .royal-cursor {
            cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><path fill='%23a83232' d='M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z'/></svg>"), auto;
        }

        .btn-royal {
            position: relative;
            overflow: hidden;
            z-index: 1;
            transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn-royal::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #a83232, #d4af37);
            z-index: -1;
            transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            opacity: 0.9;
        }

        .btn-royal:hover::before {
            opacity: 1;
            transform: scale(1.05);
        }

        .btn-royal::after {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            transform: translate(-25%, -25%);
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .btn-royal:hover::after {
            opacity: 1;
        }

        .wax-seal {
            position: absolute;
            width: 90px;
            height: 90px;
            background: radial-gradient(circle at center, #a83232, #8a2525);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #d4af37;
            font-size: 1.8rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 3px solid rgba(212, 175, 55, 0.5);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            cursor: pointer;
            z-index: 10;
        }

        .wax-seal:hover {
            transform: rotate(0deg) scale(1.1);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .wax-seal::after {
            content: "";
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle at center, transparent 60%, rgba(0,0,0,0.1) 100%);
        }

        .wax-drip {
            position: absolute;
            width: 8px;
            height: 20px;
            background: #a83232;
            border-radius: 0 0 4px 4px;
            animation: waxDrip 2s infinite;
        }

        .pigeon {
            position: fixed;
            font-size: 2.5rem;
            z-index: 100;
            animation: fly 15s linear infinite;
            opacity: 0;
            filter: drop-shadow(3px 5px 8px rgba(0,0,0,0.4));
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .feather {
            position: absolute;
            font-size: 1.5rem;
            opacity: 0;
            z-index: 10;
            animation: featherFall linear forwards;
            filter: drop-shadow(1px 2px 3px rgba(0,0,0,0.2));
        }

        .royal-decoration {
            position: absolute;
            font-size: 1.8rem;
            opacity: 0.15;
            z-index: -1;
            color: #4a306d;
        }

        .visible {
            display: block;
            animation: floatIn 0.8s ease-out;
        }

        .spinner {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
            vertical-align: middle;
        }

        .scroll-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0) translateX(-50%); }
            40% { transform: translateY(-20px) translateX(-50%); }
            60% { transform: translateY(-10px) translateX(-50%); }
        }

        .scroll-indicator::before {
            content: "‚Üì";
            font-size: 1.5rem;
            color: #4a306d;
            opacity: 0.7;
        }

        .ink-splash {
            position: absolute;
            width: 100px;
            height: 100px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="%232a2118" d="M30,10 Q50,5 70,20 Q85,40 80,60 Q75,85 50,90 Q25,85 20,60 Q15,40 30,10" opacity="0.1"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            z-index: -1;
        }
    </style>
</head>
<body class="font-cormorant bg-parchment-dark text-ink royal-cursor bg-[url('https://www.transparenttextures.com/patterns/rice-paper.png')]">
    <div class="container max-w-4xl mx-auto px-4 py-8 relative z-10">
        <!-- Pigeon messenger -->
        <div class="pigeon" id="pigeon">üïäÔ∏è</div>

        <!-- Royal Decoration Elements -->
        <div class="royal-decoration" style="top: 5%; left: 3%;">‚öú</div>
        <div class="royal-decoration" style="top: 15%; right: 5%; transform: rotate(15deg);">‚úí</div>
        <div class="royal-decoration" style="bottom: 10%; left: 8%; transform: rotate(-15deg);">üñã</div>
        <div class="royal-decoration" style="bottom: 25%; right: 10%;">üìú</div>

        <!-- Ink splashes -->
        <div class="ink-splash" style="top: 20%; left: 10%; transform: rotate(20deg); opacity: 0.1;"></div>
        <div class="ink-splash" style="bottom: 15%; right: 15%; transform: rotate(-15deg); opacity: 0.08;"></div>

        <!-- Royal Header -->
        <header class="text-center mb-12 relative p-12 bg-parchment rounded-lg shadow-xl border border-wax-red/30 transform transition duration-500 hover:-translate-y-1 hover:rotate-1 bg-[url('https://www.transparenttextures.com/patterns/rice-paper-2.png')]">
            <div class="wax-seal right-[-25px] bottom-[-25px] rotate-15">‚úâ</div>
            <div class="wax-drip left-5" style="animation-delay: 0.3s;"></div>
            <div class="wax-drip left-10" style="animation-delay: 0.6s;"></div>
            <h1 class="font-playfair text-5xl font-bold mb-6 text-transparent bg-clip-text bg-gradient-to-br from-royal-purple to-wax-red tracking-wider">
                Your Majesty
            </h1>
            <p class="intro-text text-xl max-w-3xl mx-auto opacity-90 text-royal-blue font-medium leading-relaxed">
                By order of the Cr(l)own, these confidential matters require your immediate attention. 
                The royal pigeon awaits your response with utmost urgency.
            </p>
            <div class="scroll-indicator"></div>
        </header>

        <!-- Name Input Section -->
        <div id="name-section" class="section visible scroll-section bg-parchment rounded-lg p-8 mb-8 shadow-lg border border-wax-red/30 relative overflow-hidden bg-[url('https://www.transparenttextures.com/patterns/rice-paper-3.png')]">
            <div class="form-group">
                <label class="block mb-4 font-marcellus font-semibold text-xl text-royal-purple">
                    Your royal title or given name:
                </label>
                <input type="text" id="name" placeholder="E.g., Queen Afrah of Bangalore" required 
                    class="w-full p-5 bg-white/50 border border-wax-red rounded-lg text-ink font-cormorant text-xl focus:outline-none focus:ring-2 focus:ring-royal-purple/30 focus:border-royal-purple transition-all duration-300">
            </div>
            <button id="name-submit-btn" class="btn-royal w-full py-4 px-8 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider mt-8">
                <span class="relative z-10">Affix Royal Seal</span>
            </button>
        </div>

        <!-- Royal Introduction Section -->
        <div id="welcome-section" class="section scroll-section bg-parchment rounded-lg p-8 mb-8 shadow-lg border border-wax-red/30 relative overflow-hidden bg-[url('https://www.transparenttextures.com/patterns/rice-paper-3.png')]">
            <div class="personal-greeting font-playfair text-4xl text-royal-purple mb-6 text-center relative w-full" id="personal-greeting">
                My Dearest Afrah
            </div>
            <div class="text-center">
                <div class="text-5xl mb-6 text-royal-purple animate-pulse-slow">üïäÔ∏è</div>
                <p class="italic mb-8 text-xl leading-relaxed">
                    "As the royal pigeon carries our words across kingdoms, so too does my concern travel to you..."
                </p>
                <div class="h-px bg-gradient-to-r from-transparent via-wax-red to-transparent my-10"></div>
                <p class="mb-8 text-xl leading-relaxed">
                    Prepare yourself for a series of highly significant inquiries. Your attention to this is needed for the socio-economic welfare of our kingdom. (plsplspslspslsppsls dont ignore and answer all i will upi you once i get to india trust)
                </p>
            </div>
            <button id="welcome-continue-btn" class="btn-royal w-full py-4 px-8 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider">
                <span class="relative z-10">Unseal the Scroll</span>
            </button>
        </div>

        <!-- Questions Sections -->
        <div id="question-1" class="section scroll-section bg-parchment rounded-lg p-8 mb-8 shadow-lg border border-wax-red/30 relative overflow-hidden bg-[url('https://www.transparenttextures.com/patterns/rice-paper-3.png')]">
            <div class="question-container bg-white/40 p-8 rounded-lg mb-8 border-l-4 border-wax-red relative">
                <div class="question-text font-semibold text-2xl mb-4 relative pl-12 before:content-['‚úâ'] before:absolute before:left-0 before:text-wax-red before:text-3xl before:top-[-0.2rem] before:transition-all before:duration-300 hover:before:transform hover:before:-translate-y-1 hover:before:rotate-12 hover:before:text-royal-purple">
                    Mind unveiling thy day's artistry?
                </div>
                <textarea placeholder="MUST ANSWER" class="w-full min-h-[180px] p-6 bg-white/50 border border-wax-red/30 rounded-lg text-ink font-cormorant text-xl resize-none shadow-inner focus:outline-none focus:ring-2 focus:ring-royal-purple/30 focus:border-royal-purple transition-all duration-300"></textarea>
            </div>
            <div class="button-group flex justify-between mt-10 gap-6">
                <button class="btn-back py-4 px-8 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider border-2 border-wax-red text-wax-red hover:bg-wax-red/10 transition-all duration-300">
                    ‚Üê Previous
                </button>
                <button class="btn-submit btn-royal py-4 px-8 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider">
                    <span class="relative z-10">Next ‚Üí</span>
                </button>
            </div>
        </div>

        <!-- Continue with other question sections (2-12) following the same pattern -->
        <!-- ... -->

        <!-- Final Section -->
        <div id="final-section" class="section scroll-section bg-parchment rounded-lg p-8 mb-8 shadow-lg border border-wax-red/30 relative overflow-hidden bg-[url('https://www.transparenttextures.com/patterns/rice-paper-3.png')]">
            <div class="text-center">
                <div class="text-6xl mb-6 text-royal-purple animate-pulse-slow">üïäÔ∏è</div>
                <p class="mb-6 text-xl leading-relaxed">
                    Thank you. Your responses will be analyzed with utmost care, grace and tears:33
                </p>
                
                <div class="confirmation-dialog bg-parchment p-10 rounded-lg mt-10 border border-wax-red hidden" id="confirmation-dialog">
                    <p class="mb-6 text-xl">Dispatch thy responses by royal pigeon?</p>
                    <div class="flex justify-center gap-6">
                        <button class="btn-confirm btn-royal py-3 px-6 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider" id="confirm-yes">
                            <span class="relative z-10">Aye</span>
                        </button>
                        <button class="btn-back py-3 px-6 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider border-2 border-wax-red text-wax-red hover:bg-wax-red/10 transition-all duration-300" id="confirm-no">
                            Review
                        </button>
                    </div>
                </div>
                
                <button id="submit-all-btn" class="btn-royal mt-10 py-4 px-8 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider" disabled>
                    <span class="relative z-10">Seal With Royal Grace</span>
                </button>
            </div>
        </div>

        <!-- Thank You Section -->
        <div id="thank-you-section" class="section scroll-section bg-parchment rounded-lg p-8 mb-8 shadow-lg border border-wax-red/30 relative overflow-hidden bg-[url('https://www.transparenttextures.com/patterns/rice-paper-3.png')]">
            <div class="text-center">
                <div class="text-7xl mb-8 text-royal-purple animate-pulse-slow">‚úâÔ∏è</div>
                <h2 class="font-playfair text-4xl mb-6 text-royal-purple">
                    Pigeon delivered your responses.
                </h2>
                <p class="mb-6 text-xl leading-relaxed">
                  The royal pigeon has flown with thy words. Though kingdoms may separate us, my care for thee remains steadfast. Should thou ever wish to correspond again, the royal pigeon shall ever be at thy service.
                </p>
                <p class="italic opacity-80 text-lg">
                     I just want to talk with you cause I care about you. No other way was working so I thought of trying this yeah I will keep trying, keep wishing, keep believing. But even if you want to just end this, please don't do without a final goodbye talk please. My only wish. Thank you. God bless you. I will never cease to keep praying for your happinessü§ç <br>
                    (Hoping that didnt piss you off and you can stop being a ghost soon inshallah amin fr)
                </p>
            </div>
            <div class="wax-seal right-[-15px] bottom-[-15px] rotate-15">üíå</div>
            <div class="wax-drip right-[30px] bottom-[-15px]" style="animation-delay: 0.3s;"></div>
            <div class="wax-drip right-[50px] bottom-[-20px]" style="animation-delay: 0.6s;"></div>
        </div>

        <audio id="bg-audio" loop>
            <source src="sorry.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
        </audio>

        <footer class="text-center mt-12 py-8 relative opacity-80">
            <div class="absolute top-0 left-1/2 transform -translate-x-1/2 w-24 h-0.5 bg-gradient-to-r from-wax-red to-wax-gold"></div>
            hope is the last thing that dies 
            <br><br>
            w1thn3v34dy1ngl0v3 <br>
            your (forgotten) friend
        </footer>
    </div>

    <script type="module">
        // Firebase imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
        import { firebaseConfig } from './firebase-config1.js';

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        document.addEventListener('DOMContentLoaded', function() {
            // Get all sections
            const sections = Array.from(document.querySelectorAll('.section'));
            
            // DOM elements
            const nameInput = document.getElementById('name');
            const nameSubmitBtn = document.getElementById('name-submit-btn');
            const personalGreeting = document.getElementById('personal-greeting');
            const welcomeContinueBtn = document.getElementById('welcome-continue-btn');
            const submitAllBtn = document.getElementById('submit-all-btn');
            const confirmDialog = document.getElementById('confirmation-dialog');
            const confirmYesBtn = document.getElementById('confirm-yes');
            const confirmNoBtn = document.getElementById('confirm-no');
            const textareas = document.querySelectorAll('textarea');
            const backButtons = document.querySelectorAll('.btn-back');
            const submitButtons = document.querySelectorAll('.btn-submit');
            const bgAudio = document.getElementById('bg-audio');
            const pigeon = document.getElementById('pigeon');
            const waxSeals = document.querySelectorAll('.wax-seal');

            // Track current section
            let currentSectionIndex = 0;
            let userName = '';

            // Initialize
            showCurrentSection();
            setupEventListeners();
            createRoyalDecorations();
            createInkSplashes();

            function showCurrentSection() {
                sections.forEach((section, index) => {
                    if (!section) return;
                    if (index === currentSectionIndex) {
                        setTimeout(() => {
                            section.classList.add('visible');
                        }, 50);
                    } else {
                        section.classList.remove('visible');
                    }
                });
            }

            function setupEventListeners() {
                const enableAudioOnce = () => {
                    bgAudio.play().catch(console.error);
                    document.removeEventListener('click', enableAudioOnce);
                    document.removeEventListener('keydown', enableAudioOnce);
                };
                document.addEventListener('click', enableAudioOnce);
                document.addEventListener('keydown', enableAudioOnce);
                
                // Name submit
                nameSubmitBtn.addEventListener('click', function() {
                    if (nameInput.value.trim() === '') {
                        nameInput.classList.add('border-wax-red', 'ring-2', 'ring-wax-red/30');
                        setTimeout(() => {
                            nameInput.classList.remove('border-wax-red', 'ring-2', 'ring-wax-red/30');
                        }, 1000);
                        return;
                    }
                    userName = nameInput.value.trim();
                    personalGreeting.textContent = `My Dearest ${userName}`;
                    navigateToNextSection();
                    createFeathers(5);
                });

                // Wax seal interactions
                waxSeals.forEach(seal => {
                    seal.addEventListener('click', function() {
                        this.style.animation = 'seal-spin 1s linear';
                        setTimeout(() => {
                            this.style.animation = '';
                        }, 1000);
                        createFeathers(1);
                    });
                });

                // Welcome continue
                welcomeContinueBtn.addEventListener('click', function() {
                    navigateToNextSection();
                    createFeathers(3);
                });

                // Question submit buttons
                submitButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const textarea = this.closest('.section').querySelector('textarea');
                        if (textarea.value.trim() === '') {
                            textarea.classList.add('border-wax-red', 'ring-2', 'ring-wax-red/30');
                            setTimeout(() => {
                                textarea.classList.remove('border-wax-red', 'ring-2', 'ring-wax-red/30');
                            }, 1000);
                            return;
                        }
                        navigateToNextSection();
                        createFeathers(2);
                    });
                });

                // Back buttons
                backButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        navigateToPreviousSection();
                        createFeathers(1);
                    });
                });

                // Submit all answers
                submitAllBtn.addEventListener('click', function() {
                    confirmDialog.classList.add('visible');
                    createFeathers(2);
                });

                // Confirmation buttons
                confirmYesBtn.addEventListener('click', submitAllAnswers);
                confirmNoBtn.addEventListener('click', function() {
                    confirmDialog.classList.remove('visible');
                });

                // Textarea validation
                textareas.forEach(textarea => {
                    textarea.addEventListener('input', function() {
                        const allAnswered = Array.from(textareas).every(ta => ta.value.trim() !== '');
                        submitAllBtn.disabled = !allAnswered;
                    });
                });
            }

            function createRoyalDecorations() {
                const decorations = ['‚öú', '‚úí', 'üñã', 'üìú', '‚úâ', 'üè∞', 'üëë'];
                for (let i = 0; i < 8; i++) {
                    const dec = document.createElement('div');
                    dec.className = 'royal-decoration';
                    dec.innerHTML = decorations[Math.floor(Math.random() * decorations.length)];
                    dec.style.top = Math.random() * 90 + 5 + '%';
                    dec.style.left = Math.random() * 90 + 5 + '%';
                    dec.style.transform = `rotate(${Math.random() * 60 - 30}deg)`;
                    dec.style.opacity = 0.1 + Math.random() * 0.1;
                    dec.style.fontSize = (1 + Math.random() * 0.5) + 'rem';
                    document.body.appendChild(dec);
                }
            }

            function createInkSplashes() {
                for (let i = 0; i < 5; i++) {
                    const splash = document.createElement('div');
                    splash.className = 'ink-splash';
                    splash.style.top = Math.random() * 90 + 5 + '%';
                    splash.style.left = Math.random() * 90 + 5 + '%';
                    splash.style.transform = `rotate(${Math.random() * 360}deg) scale(${0.5 + Math.random() * 1.5})`;
                    splash.style.opacity = 0.05 + Math.random() * 0.1;
                    document.body.appendChild(splash);
                }
            }

            function navigateToSection(index) {
                if (index >= 0 && index < sections.length) {
                    currentSectionIndex = index;
                    showCurrentSection();
                    window.scrollTo({
                        top: sections[currentSectionIndex].offsetTop - 50,
                        behavior: 'smooth'
                    });
                }
            }

            function navigateToNextSection() {
                navigateToSection(currentSectionIndex + 1);
            }

            function navigateToPreviousSection() {
                navigateToSection(currentSectionIndex - 1);
            }

            function createFeathers(count) {
                for (let i = 0; i < count; i++) {
                    const feather = document.createElement('div');
                    feather.className = 'feather';
                    feather.innerHTML = 'ü™∂';
                    feather.style.left = Math.random() * 100 + 'vw';
                    feather.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    feather.style.animationDelay = (Math.random() * 0.5) + 's';
                    feather.style.opacity = 0.7 + Math.random() * 0.3;
                    document.body.appendChild(feather);
                    
                    // Remove feather after animation completes
                    setTimeout(() => {
                        feather.remove();
                    }, 5000);
                }
            }

            async function submitAllAnswers() {
                confirmDialog.classList.remove('visible');
                submitAllBtn.disabled = true;
                submitAllBtn.innerHTML = '<span class="spinner"></span> Dispatching Pigeon...';
                
                // Animate pigeon
                pigeon.style.animation = 'fly 5s linear forwards';
                pigeon.style.left = '20px';
                pigeon.style.top = '50%';
                
                // Create more feathers for submission
                createFeathers(10);

                const formData = {
                    name: userName,
                    timestamp: new Date(),
                    answers: []
                };

                // Get all questions and answers
                for (let i = 2; i <= 14; i++) {
                    const section = sections[i];
                    if (section) {
                        formData.answers.push({
                            question: section.querySelector('.question-text').textContent,
                            answer: section.querySelector('textarea').value
                        });
                    }
                }

                try {
                    await addDoc(collection(db, "royalResponses"), formData);
                    setTimeout(() => {
                        navigateToSection(sections.length - 1);
                        submitAllBtn.textContent = 'Message Delivered';
                        createFeathers(5);
                    }, 3000);
                } catch (e) {
                    console.error("Error:", e);
                    submitAllBtn.disabled = false;
                    submitAllBtn.textContent = 'Seal With Royal Wax';
                    pigeon.style.animation = 'none';
                }
            }
        });
    </script>
</body>
</html>
