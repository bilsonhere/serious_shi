<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pardon My Impatience</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Marcellus&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    <style type="text/tailwindcss">
        @layer base {
            body {
                font-family: 'Cormorant Garamond', serif;
                @apply bg-amber-50 text-amber-950 min-h-screen overflow-x-hidden;
                background-image: 
                    url('https://www.transparenttextures.com/patterns/rice-paper.png'),
                    linear-gradient(to bottom, rgba(26, 26, 46, 0.05), transparent);
            }
        }

        @layer components {
            .royal-header {
                @apply text-center mb-12 relative p-12 bg-amber-50 rounded-lg shadow-xl border border-red-300/30;
                background-image: 
                    url('https://www.transparenttextures.com/patterns/rice-paper-2.png'),
                    linear-gradient(to bottom right, rgba(255,255,255,0.8), rgba(245,233,213,0.9));
            }

            .section {
                @apply bg-amber-50 rounded-lg p-8 mb-8 shadow-lg border border-red-300/30 hidden;
                background-image: url('https://www.transparenttextures.com/patterns/rice-paper-3.png');
            }

            .wax-seal {
                @apply absolute w-24 h-24 rounded-full flex items-center justify-center text-3xl;
                background: radial-gradient(circle at center, #a83232, #8a2525);
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                border: 3px solid rgba(212, 175, 55, 0.5);
            }

            .question-text {
                @apply font-cormorant text-2xl font-semibold mb-4 relative pl-12;
            }
        }

        @layer utilities {
            .font-cormorant {
                font-family: 'Cormorant Garamond', serif;
            }
            .font-playfair {
                font-family: 'Playfair Display', serif;
            }
            .font-marcellus {
                font-family: 'Marcellus', serif;
            }
        }

        @keyframes floatIn {
            0% { transform: translateY(30px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }

        @keyframes fly {
            0% { 
                transform: translateX(-100px) translateY(100px) rotate(-10deg);
                opacity: 0;
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { 
                transform: translateX(calc(100vw + 100px)) translateY(-100px) rotate(10deg);
                opacity: 0;
            }
        }

        @keyframes featherFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 0.8;
            }
            100% {
                transform: translateY(calc(100vh + 100px)) rotate(360deg);
                opacity: 0;
            }
        }

        .visible {
            @apply block;
            animation: floatIn 0.8s ease-out;
        }

        .pigeon {
            @apply fixed text-4xl z-50 opacity-0;
            filter: drop-shadow(3px 5px 8px rgba(0,0,0,0.4));
            animation: fly 15s linear infinite;
        }

        .feather {
            @apply absolute text-xl opacity-0 z-10;
            animation: featherFall linear forwards;
            filter: drop-shadow(1px 2px 3px rgba(0,0,0,0.2));
        }

        .royal-decoration {
            @apply absolute text-2xl opacity-15 -z-10;
            color: #4a306d;
        }

        .wax-drip {
            @apply absolute w-2 h-6;
            background: #a83232;
            border-radius: 0 0 4px 4px;
            animation: waxDrip 2s infinite;
        }

        @keyframes waxDrip {
            0% { transform: translateY(-10px) scaleY(0.8); opacity: 0; }
            50% { transform: translateY(0) scaleY(1); opacity: 1; }
            100% { transform: translateY(10px) scaleY(0.8); opacity: 0; }
        }

        .spinner {
            @apply inline-block w-6 h-6 border-2 border-white/30 rounded-full border-t-white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        textarea {
            @apply w-full min-h-[180px] p-6 bg-white/50 border border-red-300/30 rounded-lg text-amber-950 font-cormorant text-xl resize-none shadow-inner;
        }

        textarea:focus {
            @apply outline-none border-purple-800 bg-white/70;
            box-shadow: 0 0 0 3px rgba(74, 48, 109, 0.1),
                        inset 0 2px 5px rgba(0,0,0,0.1);
        }

        textarea::-webkit-scrollbar {
            @apply w-2;
        }

        textarea::-webkit-scrollbar-track {
            @apply bg-red-300/10 rounded;
        }

        textarea::-webkit-scrollbar-thumb {
            @apply bg-red-800 rounded border-2 border-white/30;
        }
    </style>
</head>
<body class="font-cormorant">
    <div class="container max-w-4xl mx-auto px-4 py-8 relative z-10">
        <!-- Pigeon messenger -->
        <div class="pigeon" id="pigeon">üïäÔ∏è</div>

        <!-- Royal Decoration Elements -->
        <div class="royal-decoration" style="top: 5%; left: 3%;">‚öú</div>
        <div class="royal-decoration" style="top: 15%; right: 5%; transform: rotate(15deg);">‚úí</div>
        <div class="royal-decoration" style="bottom: 10%; left: 8%; transform: rotate(-15deg);">üñã</div>
        <div class="royal-decoration" style="bottom: 25%; right: 10%;">üìú</div>

        <!-- Royal Header -->
        <header class="royal-header transform transition duration-500 hover:-translate-y-1 hover:rotate-1">
            <div class="wax-seal right-[-25px] bottom-[-25px] rotate-15 transition duration-400 hover:rotate-0 hover:scale-110">‚úâ</div>
            <div class="wax-drip left-5" style="animation-delay: 0.3s;"></div>
            <div class="wax-drip left-10" style="animation-delay: 0.6s;"></div>
            <h1 class="font-playfair text-5xl font-bold mb-6 text-transparent bg-clip-text bg-gradient-to-br from-purple-800 to-red-800">
                Your Majesty
            </h1>
            <p class="intro-text font-cormorant text-xl max-w-3xl mx-auto opacity-90 text-blue-900 font-medium">
                By order of the Cr(l)own, these confidential matters require your immediate attention. 
                The royal pigeon awaits your response with utmost urgency.
            </p>
        </header>

        <!-- Name Input Section -->
        <div id="name-section" class="section visible">
            <div class="form-group">
                <label class="block mb-4 font-marcellus font-semibold text-xl text-purple-800">
                    Your royal title or given name:
                </label>
                <input type="text" id="name" placeholder="E.g., Queen Afrah of Bangalore" required 
                    class="w-full p-5 bg-white/50 border border-red-800 rounded-lg text-amber-950 font-cormorant text-xl">
            </div>
            <button id="name-submit-btn" class="btn mt-8 w-full py-4 px-8 border-none rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider shadow-md relative overflow-hidden">
                <span class="relative z-10">Affix Royal Seal</span>
            </button>
        </div>

        <!-- Royal Introduction Section -->
        <div id="welcome-section" class="section">
            <div class="personal-greeting font-playfair text-4xl text-purple-800 mb-6 text-center relative w-full" id="personal-greeting">
                My Dearest Afrah
            </div>
            <div class="text-center">
                <div class="text-5xl mb-6 text-purple-800">üïäÔ∏è</div>
                <p class="italic mb-8 font-cormorant text-xl">
                    "As the royal pigeon carries our words across kingdoms, so too does my concern travel to you..."
                </p>
                <div class="h-px bg-gradient-to-r from-transparent via-red-800 to-transparent my-10"></div>
                <p class="mb-8 text-xl leading-loose">
                    Prepare yourself for a series of highly significant inquiries. Your attention to this is needed for the socio-economic welfare of our kingdom. (plsplspslspslsppsls dont ignore and answer all i will upi you once i get to india trust)
                </p>
            </div>
            <button id="welcome-continue-btn" class="btn w-full py-4 px-8 border-none rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider shadow-md relative overflow-hidden">
                <span class="relative z-10">Unseal the Scroll</span>
            </button>
        </div>

        <!-- Questions Sections -->
        <div id="question-1" class="section">
            <div class="question-container bg-white/40 p-8 rounded-lg mb-8 border-l-4 border-red-800 relative">
                <div class="question-text">Mind unveiling thy day's artistry?</div>
                <textarea placeholder="MUST ANSWER"></textarea>
            </div>
            <div class="button-group flex justify-between mt-10 gap-6">
                <button class="btn-back py-4 px-8 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider border-2 border-red-800 text-red-800 hover:bg-red-800/10 transition-all">
                    ‚Üê Previous
                </button>
                <button class="btn-submit py-4 px-8 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider shadow-md relative overflow-hidden">
                    <span class="relative z-10">Next ‚Üí</span>
                </button>
            </div>
        </div>

        <!-- Repeat similar structure for questions 2-12 -->
        <div id="question-2" class="section">
            <div class="question-container bg-white/40 p-8 rounded-lg mb-8 border-l-4 border-red-800 relative">
                <div class="question-text">What news of the weather in your realm?</div>
                <textarea placeholder="MUST ANSWER"></textarea>
            </div>
            <div class="button-group flex justify-between mt-10 gap-6">
                <button class="btn-back py-4 px-8 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider border-2 border-red-800 text-red-800 hover:bg-red-800/10 transition-all">
                    ‚Üê Previous
                </button>
                <button class="btn-submit py-4 px-8 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider shadow-md relative overflow-hidden">
                    <span class="relative z-10">Next ‚Üí</span>
                </button>
            </div>
        </div>

        <!-- Continue with questions 3-12 following the same pattern -->
        <!-- ... -->

        <!-- Final Section -->
        <div id="final-section" class="section">
            <div class="text-center">
                <div class="text-6xl mb-6 text-purple-800">üïäÔ∏è</div>
                <p class="mb-6 text-xl leading-loose">
                    Thank you. Your responses will be analyzed with utmost care, grace and tears:33
                </p>
                
                <div class="confirmation-dialog bg-amber-50 p-10 rounded-lg mt-10 border border-red-800 hidden" id="confirmation-dialog">
                    <p class="mb-6 text-xl">Dispatch thy responses by royal pigeon?</p>
                    <div class="flex justify-center gap-6">
                        <button class="btn py-3 px-6 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider shadow-md relative overflow-hidden" id="confirm-yes">
                            <span class="relative z-10">Aye</span>
                        </button>
                        <button class="btn-back py-3 px-6 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider border-2 border-red-800 text-red-800 hover:bg-red-800/10 transition-all" id="confirm-no">
                            Review
                        </button>
                    </div>
                </div>
                
                <button id="submit-all-btn" class="btn mt-10 py-4 px-8 rounded-lg font-marcellus font-semibold text-lg uppercase tracking-wider shadow-md relative overflow-hidden" disabled>
                    <span class="relative z-10">Seal With Royal Grace</span>
                </button>
            </div>
        </div>

        <!-- Thank You Section -->
        <div id="thank-you-section" class="section">
            <div class="text-center">
                <div class="text-7xl mb-8 text-purple-800">‚úâÔ∏è</div>
                <h2 class="font-playfair text-4xl mb-6 text-purple-800">
                    Pigeon delivered your responses.
                </h2>
                <p class="mb-6 text-xl leading-loose">
                  The royal pigeon has flown with thy words. Though kingdoms may separate us, my care for thee remains steadfast. Should thou ever wish to correspond again, the royal pigeon shall ever be at thy service.
                </p>
                <p class="italic opacity-80 text-lg">
                     I just want to talk with you cause I care about you. No other way was working so I thought of trying this yeah I will keep trying, keep wishing, keep believing. But even if you want to just end this, please don't do without a final goodbye talk please. My only wish. Thank you. God bless you. I will never cease to keep praying for your happinessü§ç <br>
                    (Hoping that didnt piss you off and you can stop being a ghost soon inshallah amin fr)
                </p>
            </div>
            <div class="wax-seal right-[-15px] bottom-[-15px] rotate-15 transition duration-400 hover:rotate-0 hover:scale-110">üíå</div>
            <div class="wax-drip right-[30px] bottom-[-15px]" style="animation-delay: 0.3s;"></div>
            <div class="wax-drip right-[50px] bottom-[-20px]" style="animation-delay: 0.6s;"></div>
        </div>

        <audio id="bg-audio" loop>
            <source src="sorry.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
        </audio>

        <footer class="text-center mt-12 py-8 relative opacity-80">
            <div class="absolute top-0 left-1/2 transform -translate-x-1/2 w-24 h-0.5 bg-gradient-to-r from-red-800 to-yellow-600"></div>
            hope is the last thing that dies 
            <br><br>
            w1thn3v34dy1ngl0v3 <br>
            your (forgotten) friend
        </footer>
    </div>

    <script type="module">
        // Firebase imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
        import { firebaseConfig } from './firebase-config1.js';

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        document.addEventListener('DOMContentLoaded', function() {
            // Get all sections
            const sections = Array.from(document.querySelectorAll('.section'));
            
            // DOM elements
            const nameInput = document.getElementById('name');
            const nameSubmitBtn = document.getElementById('name-submit-btn');
            const personalGreeting = document.getElementById('personal-greeting');
            const welcomeContinueBtn = document.getElementById('welcome-continue-btn');
            const submitAllBtn = document.getElementById('submit-all-btn');
            const confirmDialog = document.getElementById('confirmation-dialog');
            const confirmYesBtn = document.getElementById('confirm-yes');
            const confirmNoBtn = document.getElementById('confirm-no');
            const textareas = document.querySelectorAll('textarea');
            const backButtons = document.querySelectorAll('.btn-back');
            const submitButtons = document.querySelectorAll('.btn-submit');
            const bgAudio = document.getElementById('bg-audio');
            const pigeon = document.getElementById('pigeon');
            const waxSeals = document.querySelectorAll('.wax-seal');
            const btns = document.querySelectorAll('.btn');

            // Add gradient background to all buttons
            btns.forEach(btn => {
                const gradient = document.createElement('div');
                gradient.className = 'absolute inset-0 bg-gradient-to-br from-red-800 to-yellow-600 opacity-90 transition duration-600 hover:opacity-100 hover:scale-105';
                gradient.style.zIndex = '-1';
                btn.appendChild(gradient);
            });

            // Track current section
            let currentSectionIndex = 0;
            let userName = '';

            // Initialize
            showCurrentSection();
            setupEventListeners();
            createRoyalDecorations();

            function showCurrentSection() {
                sections.forEach((section, index) => {
                    if (!section) return;
                    if (index === currentSectionIndex) {
                        setTimeout(() => {
                            section.classList.add('visible');
                        }, 50);
                    } else {
                        section.classList.remove('visible');
                    }
                });
            }

            function setupEventListeners() {
                const enableAudioOnce = () => {
                    bgAudio.play().catch(console.error);
                    document.removeEventListener('click', enableAudioOnce);
                    document.removeEventListener('keydown', enableAudioOnce);
                };
                document.addEventListener('click', enableAudioOnce);
                document.addEventListener('keydown', enableAudioOnce);
                
                // Name submit
                nameSubmitBtn.addEventListener('click', function() {
                    if (nameInput.value.trim() === '') {
                        nameInput.classList.add('border-red-800', 'shadow-[0_0_0_3px_rgba(168,50,50,0.2)]');
                        setTimeout(() => {
                            nameInput.classList.remove('border-red-800', 'shadow-[0_0_0_3px_rgba(168,50,50,0.2)]');
                        }, 1000);
                        return;
                    }
                    userName = nameInput.value.trim();
                    personalGreeting.textContent = `My Dearest ${userName}`;
                    navigateToNextSection();
                    createFeathers(5);
                });

                // Wax seal interactions
                waxSeals.forEach(seal => {
                    seal.addEventListener('click', function() {
                        this.style.transform = 'rotate(360deg) scale(1.2)';
                        setTimeout(() => {
                            this.style.transform = 'rotate(15deg) scale(1)';
                        }, 1000);
                        createFeathers(1);
                    });
                });

                // Welcome continue
                welcomeContinueBtn.addEventListener('click', function() {
                    navigateToNextSection();
                    createFeathers(3);
                });

                // Question submit buttons
                submitButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const textarea = this.closest('.section').querySelector('textarea');
                        if (textarea.value.trim() === '') {
                            textarea.classList.add('border-red-800', 'shadow-[0_0_0_3px_rgba(168,50,50,0.2)]');
                            setTimeout(() => {
                                textarea.classList.remove('border-red-800', 'shadow-[0_0_0_3px_rgba(168,50,50,0.2)]');
                            }, 1000);
                            return;
                        }
                        navigateToNextSection();
                        createFeathers(2);
                    });
                });

                // Back buttons
                backButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        navigateToPreviousSection();
                        createFeathers(1);
                    });
                });

                // Submit all answers
                submitAllBtn.addEventListener('click', function() {
                    confirmDialog.classList.add('visible');
                    createFeathers(2);
                });

                // Confirmation buttons
                confirmYesBtn.addEventListener('click', submitAllAnswers);
                confirmNoBtn.addEventListener('click', function() {
                    confirmDialog.classList.remove('visible');
                });

                // Textarea validation
                textareas.forEach(textarea => {
                    textarea.addEventListener('input', function() {
                        const allAnswered = Array.from(textareas).every(ta => ta.value.trim() !== '');
                        submitAllBtn.disabled = !allAnswered;
                    });
                });
            }

            function createRoyalDecorations() {
                const decorations = ['‚öú', '‚úí', 'üñã', 'üìú', '‚úâ', 'üè∞', 'üëë'];
                for (let i = 0; i < 8; i++) {
                    const dec = document.createElement('div');
                    dec.className = 'royal-decoration';
                    dec.innerHTML = decorations[Math.floor(Math.random() * decorations.length)];
                    dec.style.top = Math.random() * 90 + 5 + '%';
                    dec.style.left = Math.random() * 90 + 5 + '%';
                    dec.style.transform = `rotate(${Math.random() * 60 - 30}deg)`;
                    dec.style.opacity = 0.1 + Math.random() * 0.1;
                    dec.style.fontSize = (1 + Math.random() * 0.5) + 'rem';
                    document.body.appendChild(dec);
                }
            }

            function navigateToSection(index) {
                if (index >= 0 && index < sections.length) {
                    currentSectionIndex = index;
                    showCurrentSection();
                    window.scrollTo({
                        top: sections[currentSectionIndex].offsetTop - 50,
                        behavior: 'smooth'
                    });
                }
            }

            function navigateToNextSection() {
                navigateToSection(currentSectionIndex + 1);
            }

            function navigateToPreviousSection() {
                navigateToSection(currentSectionIndex - 1);
            }

            function createFeathers(count) {
                for (let i = 0; i < count; i++) {
                    const feather = document.createElement('div');
                    feather.className = 'feather';
                    feather.innerHTML = 'ü™∂';
                    feather.style.left = Math.random() * 100 + 'vw';
                    feather.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    feather.style.animationDelay = (Math.random() * 0.5) + 's';
                    feather.style.opacity = 0.7 + Math.random() * 0.3;
                    document.body.appendChild(feather);
                    
                    // Remove feather after animation completes
                    setTimeout(() => {
                        feather.remove();
                    }, 5000);
                }
            }

            async function submitAllAnswers() {
                confirmDialog.classList.remove('visible');
                submitAllBtn.disabled = true;
                submitAllBtn.innerHTML = '<span class="spinner"></span> Dispatching Pigeon...';
                
                // Animate pigeon
                pigeon.style.animation = 'fly 5s linear forwards';
                pigeon.style.left = '20px';
                pigeon.style.top = '50%';
                
                // Create more feathers for submission
                createFeathers(10);

                const formData = {
                    name: userName,
                    timestamp: new Date(),
                    answers: []
                };

                // Get all questions and answers
                for (let i = 2; i <= 14; i++) {
                    const section = sections[i];
                    if (section) {
                        formData.answers.push({
                            question: section.querySelector('.question-text').textContent,
                            answer: section.querySelector('textarea').value
                        });
                    }
                }

                try {
                    await addDoc(collection(db, "royalResponses"), formData);
                    setTimeout(() => {
                        navigateToSection(sections.length - 1);
                        submitAllBtn.textContent = 'Message Delivered';
                        createFeathers(5);
                    }, 3000);
                } catch (e) {
                    console.error("Error:", e);
                    submitAllBtn.disabled = false;
                    submitAllBtn.textContent = 'Seal With Royal Wax';
                    pigeon.style.animation = 'none';
                }
            }
        });
    </script>
</body>
</html>
