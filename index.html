<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pardon My Impatience</title>
    <style>
        :root {
            --parchment: #f5e9d5;
            --aged-parchment: #e8d9b5;
            --ink: #2a2118;
            --wax-red: #a83232;
            --wax-gold: #d4af37;
            --royal-purple: #4a306d;
            --transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cormorant Garamond', serif;
            background-color: var(--aged-parchment);
            color: var(--ink);
            min-height: 100vh;
            overflow-x: hidden;
            background-image: 
                url('https://www.transparenttextures.com/patterns/rice-paper.png');
        }

        @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Marcellus&display=swap');

        .container {
            max-width: 700px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        /* Royal Header */
        header {
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
            padding: 3rem 2rem;
            background: var(--parchment);
            border-radius: 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 12px solid transparent;
            border-image: url('https://www.transparenttextures.com/patterns/rice-paper.png') 30 round;
            transform-style: preserve-3d;
            perspective: 1000px;
            overflow: hidden;
        }

        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://www.transparenttextures.com/patterns/rice-paper-2.png');
            opacity: 0.3;
            z-index: -1;
        }

        h1 {
            font-family: 'Marcellus', serif;
            font-size: 3.2rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--royal-purple);
            letter-spacing: 1px;
            position: relative;
            display: inline-block;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        h1::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: var(--wax-red);
            border-radius: 3px;
        }

        .intro-text {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.2rem;
            line-height: 1.8;
            max-width: 600px;
            margin: 0 auto;
            opacity: 0.9;
        }

        /* Sections with parchment styling */
        .section {
            background: var(--parchment);
            border-radius: 0;
            padding: 3rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(168, 50, 50, 0.2);
            display: none;
            transform: translateY(20px);
            opacity: 0;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            border-image: url('https://www.transparenttextures.com/patterns/rice-paper-3.png') 30 round;
        }

        .section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--wax-red), var(--wax-gold));
        }

        .section.visible {
            display: block;
            transform: translateY(0);
            opacity: 1;
            animation: floatIn 0.8s ease-out;
        }

        /* Question styling */
        .question-text {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 2rem;
            color: var(--ink);
            position: relative;
            padding-left: 2rem;
        }

        .question-text::before {
            content: "‚úí";
            position: absolute;
            left: 0;
            color: var(--wax-red);
            font-size: 1.8rem;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(168, 50, 50, 0.3);
            border-radius: 0;
            color: var(--ink);
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.1rem;
            line-height: 1.6;
            resize: none;
            transition: var(--transition);
            border-image: url('https://www.transparenttextures.com/patterns/rice-paper-3.png') 30 round;
        }

        textarea:focus {
            outline: none;
            border-color: var(--royal-purple);
            box-shadow: 0 0 0 3px rgba(74, 48, 109, 0.1);
            background: rgba(255, 255, 255, 0.4);
        }

        /* Button styles */
        .btn {
            padding: 1rem 2.5rem;
            border: none;
            border-radius: 0;
            font-family: 'Cormorant Garamond', serif;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            z-index: 1;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .btn::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, var(--wax-red), var(--wax-gold));
            z-index: -1;
            transition: var(--transition);
            opacity: 0.8;
        }

        .btn:hover::before {
            opacity: 1;
            transform: scale(1.05);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-block {
            display: block;
            width: 100%;
        }

        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            gap: 1rem;
        }

        .btn-back {
            background: transparent;
            border: 1px solid var(--wax-red);
            color: var(--wax-red);
        }

        .btn-back::before {
            display: none;
        }

        .btn-back:hover {
            background: rgba(168, 50, 50, 0.1);
        }

        /* Confirmation dialog */
        .confirmation-dialog {
            background: var(--parchment);
            padding: 2rem;
            border-radius: 0;
            margin-top: 2rem;
            border: 1px solid var(--wax-red);
            display: none;
            animation: fadeIn 0.6s ease-out;
            position: relative;
            border-image: url('https://www.transparenttextures.com/patterns/rice-paper-3.png') 30 round;
        }

        .confirmation-dialog.visible {
            display: block;
        }

        /* Wax seal styling */
        .wax-seal {
            position: absolute;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle at center, var(--wax-red), #8a2525);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--wax-gold);
            font-size: 1.5rem;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            right: -20px;
            bottom: -20px;
            transform: rotate(15deg);
            z-index: 2;
            border: 2px solid rgba(212, 175, 55, 0.5);
        }

        /* Pigeon animation */
        .pigeon {
            position: fixed;
            font-size: 2rem;
            z-index: 100;
            animation: fly 15s linear infinite;
            opacity: 0;
        }

        /* Animations */
        @keyframes floatIn {
            0% { transform: translateY(30px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }

        @keyframes fly {
            0% { 
                transform: translateX(-100px) translateY(100px) rotate(-10deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% { 
                transform: translateX(calc(100vw + 100px)) translateY(-100px) rotate(10deg);
                opacity: 0;
            }
        }

        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container { padding: 1.5rem; }
            h1 { font-size: 2.2rem; }
            .intro-text { font-size: 1rem; }
            .section { padding: 1.8rem; }
            .personal-greeting { font-size: 2rem; }
            .ready-options { flex-direction: column; gap: 1rem; }
            .ready-btn { width: 100%; }
            .button-group { flex-direction: column; gap: 1rem; }
            .btn-back { margin-right: 0; order: 2; }
            .btn-submit { order: 1; }
        }

        @media (max-width: 480px) {
            .container { padding: 1rem; }
            h1 { font-size: 1.8rem; }
            .btn { padding: 0.7rem 1.5rem; }
            .question-text { font-size: 1.2rem; }
            .wax-seal { width: 60px; height: 60px; font-size: 1.2rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Pigeon messenger -->
        <div class="pigeon" id="pigeon">üïäÔ∏è</div>

        <!-- Royal Header -->
        <header>
            <div class="wax-seal">‚úâ</div>
            <h1>Your Majesty</h1>
            <p class="intro-text">
                By order of the Cr(l)own, these confidential matters require your immediate attention. 
                The royal pigeon awaits your response with utmost urgency.
            </p>
        </header>

        <!-- Name Input Section -->
        <div id="name-section" class="section visible">
            <div class="form-group">
                <label for="name" style="display: block; margin-bottom: 1rem; font-family: 'Cormorant Garamond', serif;">
                    Your royal title or given name:
                </label>
                <input type="text" id="name" placeholder="E.g., Queen Afrah of Bangalore" required 
                    style="width: 100%; padding: 1rem; background: rgba(255,255,255,0.3); 
                    border: 1px solid var(--wax-red); border-radius: 0; color: var(--ink); font-family: 'Cormorant Garamond', serif;">
            </div>
            <button id="name-submit-btn" class="btn btn-block" style="margin-top: 1.5rem;">
                Affix Royal Seal
            </button>
        </div>

        <!-- Royal Introduction Section -->
        <div id="welcome-section" class="section">
            <div class="personal-greeting" id="personal-greeting">To My Dearest Afrah</div>
            <div style="text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 1rem;">üïäÔ∏è</div>
                <p style="font-style: italic; margin-bottom: 2rem; font-family: 'Cormorant Garamond', serif;">
                    "As the royal pigeon carries our words across kingdoms, so too does my concern travel to you..."
                </p>
                <div style="height: 1px; background: linear-gradient(to right, transparent, var(--wax-red), transparent); margin: 2rem 0;"></div>
                <p style="margin-bottom: 2rem;">
                    The Crown requests your response to these matters of great import. Please answer all inquiries with royal honesty.
                </p>
            </div>
            <button id="welcome-continue-btn" class="btn btn-block">
                Unseal the Scroll
            </button>
        </div>

        <!-- Royal Inquiries -->
        <div id="question-1" class="section">
            <div class="question-text">Mind unveiling thy day's artistry?</div>
            <textarea placeholder="The Crown demands an answer"></textarea>
            <div class="button-group">
                <button class="btn btn-back">‚Üê Previous</button>
                <button class="btn btn-submit">Next ‚Üí</button>
            </div>
        </div>

        <div id="question-2" class="section">
            <div class="question-text">What news of the weather in your realm?</div>
            <textarea placeholder="The Crown demands an answer"></textarea>
            <div class="button-group">
                <button class="btn btn-back">‚Üê Previous</button>
                <button class="btn btn-submit">Next ‚Üí</button>
            </div>
        </div>

        <div id="question-3" class="section">
            <div class="question-text">Have the royal physicians attended to thy braces?</div>
            <textarea placeholder="The Crown demands an answer"></textarea>
            <div class="button-group">
                <button class="btn btn-back">‚Üê Previous</button>
                <button class="btn btn-submit">Next ‚Üí</button>
            </div>
        </div>

        <div id="question-4" class="section">
            <div class="question-text">Has the royal kitchen served thee popcorn chicken biryani?</div>
            <textarea placeholder="The Crown demands an answer"></textarea>
            <div class="button-group">
                <button class="btn btn-back">‚Üê Previous</button>
                <button class="btn btn-submit">Next ‚Üí</button>
            </div>
        </div>
        
        <div id="question-5" class="section">
            <div class="question-text">Didst thou meet with the Turkish envoy before departing Bihar?</div>
            <textarea placeholder="The Crown demands an answer"></textarea>
            <div class="button-group">
                <button class="btn btn-back">‚Üê Previous</button>
                <button class="btn btn-submit">Next ‚Üí</button>
            </div>
        </div>
        
        <div id="question-6" class="section">
            <div class="question-text">Have thy royal studies commenced?</div>
            <textarea placeholder="The Crown demands an answer"></textarea>
            <div class="button-group">
                <button class="btn btn-back">‚Üê Previous</button>
                <button class="btn btn-submit">Next ‚Üí</button>
            </div>
        </div>

        <div id="question-7" class="section">
            <div class="question-text">Which royal sibling dost thou miss most dearly?</div>
            <textarea placeholder="The Crown demands an answer"></textarea>
            <div class="button-group">
                <button class="btn btn-back">‚Üê Previous</button>
                <button class="btn btn-submit">Next ‚Üí</button>
            </div>
        </div>

        <div id="question-8" class="section">
            <div class="question-text">Dost thou miss the lands of Bihar?</div>
            <textarea placeholder="The Crown demands an answer"></textarea>
            <div class="button-group">
                <button class="btn btn-back">‚Üê Previous</button>
                <button class="btn btn-submit">Next ‚Üí</button>
            </div>
        </div>

        <div id="question-9" class="section">
            <div class="question-text">How fares Bangalore to thee so far?</div>
            <textarea placeholder="The Crown demands an answer"></textarea>
            <div class="button-group">
                <button class="btn btn-back">‚Üê Previous</button>
                <button class="btn btn-submit">Next ‚Üí</button>
            </div>
        </div>
        
        <div id="question-10" class="section">
            <div class="question-text">By thy honor, dost thou hold me in contempt?</div>
            <textarea placeholder="Answer with royal honesty"></textarea>
            <div class="button-group">
                <button class="btn btn-back">‚Üê Previous</button>
                <button class="btn btn-submit">Next ‚Üí</button>
            </div>
        </div>

        <div id="question-11" class="section">
            <div class="question-text">Shall our correspondence continue in this lifetime?</div>
            <textarea placeholder="If aye, when might the royal pigeon find thee?"></textarea>
            <div class="button-group">
                <button class="btn btn-back">‚Üê Previous</button>
                <button class="btn btn-submit">Next ‚Üí</button>
            </div>
        </div>

        <div id="question-12" class="section">
            <div class="question-text">What must this humble servant do to regain thy royal favor?</div>
            <textarea placeholder="Speak thy mind freely"></textarea>
            <div class="button-group">
                <button class="btn btn-back">‚Üê Previous</button>
                <button class="btn btn-submit">Next ‚Üí</button>
            </div>
        </div>

        <div id="question-13" class="section">
            <div class="question-text">Any words/punishment for this loyal subject?</div>
            <textarea placeholder="Thy words are precious"></textarea>
            <div class="button-group">
                <button class="btn btn-back">‚Üê Previous</button>
                <button class="btn btn-submit">Next ‚Üí</button>
            </div>
            <div class="wax-seal">‚úâ</div>
        </div>

        <!-- Final Section -->
        <div id="final-section" class="section">
            <div style="text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 1rem;">üïäÔ∏è</div>
                <p style="margin-bottom: 1.5rem;">
                    The royal pigeon stands ready to carry thy responses to the Crown.
                </p>
                
                <div class="confirmation-dialog" id="confirmation-dialog">
                    <p style="margin-bottom: 1rem;">Dispatch thy responses by royal pigeon?</p>
                    <div style="display: flex; justify-content: center; gap: 1rem;">
                        <button class="btn" id="confirm-yes">Aye</button>
                        <button class="btn btn-back" id="confirm-no">Review</button>
                    </div>
                </div>
                
                <button id="submit-all-btn" class="btn" style="margin-top: 2rem;" disabled>
                    Seal With Royal Wax
                </button>
            </div>
        </div>

        <!-- Thank You Section -->
        <div id="thank-you-section" class="section">
            <div style="text-align: center;">
                <div style="font-size: 4rem; margin-bottom: 1.5rem;">‚úâÔ∏è</div>
                <h2 style="font-family: 'Marcellus', serif; margin-bottom: 1rem;">
                    Message Delivered by the Royal Pigeon. 
                </h2>
                <p style="margin-bottom: 1rem;">
                  The royal pigeon has flown with thy words. Though kingdoms may separate us, my care for thee remains steadfast. Should thou ever wish to correspond again, the royal pigeon shall ever be at thy service.
                </p>
                <p style="font-style: italic; opacity: 0.8;">
                  I just want to talk with you cause I care about you. No other way was working so I thought of trying this yeah I will keep trying, keep wishing, keep believing. But even if you want to just end this, please don't do without a final goodbye talk please. My only wish. Thank you. God bless you. I will never cease to keep praying for your happinessü§ç  <br> <br>
                       (May the winds carry this message to thy heart)
                                                                                                                                                                                                                                                                                                                                                                                     
                </p>
            </div>
            <div class="wax-seal">üíå</div>
        </div>

        <audio id="bg-audio" loop>
            <source src="sorry.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
        </audio>

        <footer style="text-align: center; margin-top: 3rem; padding: 2rem 0; font-family: 'Cormorant Garamond', serif; opacity: 0.7;">
          hope is the last thing that dies <br> <br>
            w1th n3v34 dy1ng l0v3 <br>
            ur (forgotten) friend
            
        </footer>
    </div>

    <script type="module">
        // Firebase imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
        import { firebaseConfig } from './firebase-config1.js';

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        document.addEventListener('DOMContentLoaded', function() {
            // Get all sections
            const sections = [
                document.getElementById('name-section'),
                document.getElementById('welcome-section'),
                document.getElementById('question-1'),
                document.getElementById('question-2'),
                document.getElementById('question-3'),
                document.getElementById('question-4'),
                document.getElementById('question-5'),
                document.getElementById('question-6'),
                document.getElementById('question-7'),
                document.getElementById('question-8'),
                document.getElementById('question-9'),
                document.getElementById('question-10'),
                document.getElementById('question-11'),
                document.getElementById('question-12'),
                document.getElementById('question-13'),
                document.getElementById('final-section'),
                document.getElementById('thank-you-section')
            ];

            // DOM elements
            const nameInput = document.getElementById('name');
            const nameSubmitBtn = document.getElementById('name-submit-btn');
            const personalGreeting = document.getElementById('personal-greeting');
            const welcomeContinueBtn = document.getElementById('welcome-continue-btn');
            const submitAllBtn = document.getElementById('submit-all-btn');
            const confirmDialog = document.getElementById('confirmation-dialog');
            const confirmYesBtn = document.getElementById('confirm-yes');
            const confirmNoBtn = document.getElementById('confirm-no');
            const textareas = document.querySelectorAll('textarea');
            const backButtons = document.querySelectorAll('.btn-back');
            const submitButtons = document.querySelectorAll('.btn-submit');
            const bgAudio = document.getElementById('bg-audio');
            const pigeon = document.getElementById('pigeon');

            // Track current section
            let currentSectionIndex = 0;
            let userName = '';

            // Initialize
            showCurrentSection();
            setupEventListeners();

            function showCurrentSection() {
                sections.forEach((section, index) => {
                    if (index === currentSectionIndex) {
                        setTimeout(() => {
                            section.classList.add('visible');
                        }, 50);
                    } else {
                        section.classList.remove('visible');
                    }
                });
            }

            function setupEventListeners() {
                const enableAudioOnce = () => {
                    bgAudio.play().catch(console.error);
                    document.removeEventListener('click', enableAudioOnce);
                    document.removeEventListener('keydown', enableAudioOnce);
                };
                document.addEventListener('click', enableAudioOnce);
                document.addEventListener('keydown', enableAudioOnce);
                
                // Name submit
                nameSubmitBtn.addEventListener('click', function() {
                    if (nameInput.value.trim() === '') {
                        return;
                    }
                    userName = nameInput.value.trim();
                    personalGreeting.textContent = `To My Dearest ${userName}`;
                    navigateToNextSection();
                });

                // Welcome continue
                welcomeContinueBtn.addEventListener('click', navigateToNextSection);

                // Question submit buttons
                submitButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const textarea = this.closest('.section').querySelector('textarea');
                        if (textarea.value.trim() === '') {
                            return;
                        }
                        navigateToNextSection();
                    });
                });

                // Back buttons
                backButtons.forEach(button => {
                    button.addEventListener('click', navigateToPreviousSection);
                });

                // Submit all answers
                submitAllBtn.addEventListener('click', function() {
                    confirmDialog.classList.add('visible');
                });

                // Confirmation buttons
                confirmYesBtn.addEventListener('click', submitAllAnswers);
                confirmNoBtn.addEventListener('click', function() {
                    confirmDialog.classList.remove('visible');
                });

                // Textarea validation
                textareas.forEach(textarea => {
                    textarea.addEventListener('input', function() {
                        const allAnswered = Array.from(textareas).every(ta => ta.value.trim() !== '');
                        submitAllBtn.disabled = !allAnswered;
                    });
                });
            }

            function navigateToSection(index) {
                if (index >= 0 && index < sections.length) {
                    currentSectionIndex = index;
                    showCurrentSection();
                    window.scrollTo({
                        top: sections[currentSectionIndex].offsetTop - 50,
                        behavior: 'smooth'
                    });
                }
            }

            function navigateToNextSection() {
                navigateToSection(currentSectionIndex + 1);
            }

            function navigateToPreviousSection() {
                navigateToSection(currentSectionIndex - 1);
            }

            async function submitAllAnswers() {
                confirmDialog.classList.remove('visible');
                submitAllBtn.disabled = true;
                submitAllBtn.textContent = 'üïä Dispatching Pigeon...';
                
                // Animate pigeon
                pigeon.style.animation = 'fly 5s linear forwards';
                pigeon.style.left = '20px';
                pigeon.style.top = '50%';

                const formData = {
                    name: userName,
                    timestamp: new Date(),
                    answers: []
                };

                // Get all questions and answers
                for (let i = 2; i <= 14; i++) {
                    const section = sections[i];
                    formData.answers.push({
                        question: section.querySelector('.question-text').textContent,
                        answer: section.querySelector('textarea').value
                    });
                }

                try {
                    await addDoc(collection(db, "royalResponses"), formData);
                    setTimeout(() => {
                        navigateToSection(sections.length - 1);
                        submitAllBtn.textContent = 'Message Delivered';
                    }, 3000);
                } catch (e) {
                    console.error("Error:", e);
                    submitAllBtn.disabled = false;
                    submitAllBtn.textContent = 'Seal With Royal Wax';
                    pigeon.style.animation = 'none';
                }
            }
        });
    </script>
</body>
</html>
